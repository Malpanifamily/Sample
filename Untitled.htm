<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Certificate Generator</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; }
    .container { max-width: 900px; margin: 20px auto; padding: 20px; background:#fff; border-radius:8px; }
    label { display:block; margin-top:10px; font-weight:bold; }
    input, textarea { width:100%; padding:8px; margin-top:5px; }
    button { margin-top:15px; padding:10px 15px; cursor:pointer; }
    #certificate {
      margin-top:20px; padding:40px; border:5px double #333;
      text-align:center; background:#fffef8;
    }
    #certificate h2 { margin:0; font-size:28px; }
    #certificate h3 { margin:10px 0; font-size:22px; }
    #certificate p { margin:10px 0; font-size:16px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Certificate Generator</h1>
    <label for="recipient">Name</label>
    <input id="recipient" type="text" placeholder="Enter recipient name">

    <label for="content">Certificate Content</label>
    <textarea id="content" placeholder="Enter certificate text"></textarea>

    <label for="issuer">Issuer</label>
    <input id="issuer" type="text" placeholder="Enter issuer name">

    <label for="date">Date</label>
    <input id="date" type="date">

    <button id="previewBtn" type="button">Preview</button>
    <button id="generateBtn" type="button">Generate & Download PDF</button>

    <!-- Certificate preview -->
    <div id="certificate">
      <h2 id="certTitle">Certificate of Achievement</h2>
      <h3 id="certRecipient">Recipient Name</h3>
      <p id="certContent">Certificate content goes here.</p>
      <p id="certIssuer">Issued by: —</p>
      <p id="certDate">Date: —</p>
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <script>
    function syncPreview() {
      const name = document.getElementById('recipient').value || 'Recipient Name';
      const text = document.getElementById('content').value || 'Certificate content goes here.';
      const issuer = document.getElementById('issuer').value || '—';
      const dateVal = document.getElementById('date').value;

      const dateStr = dateVal ? new Date(dateVal).toLocaleDateString() : '—';

      document.getElementById('certRecipient').textContent = name;
      document.getElementById('certContent').textContent = text;
      document.getElementById('certIssuer').textContent = 'Issued by: ' + issuer;
      document.getElementById('certDate').textContent = 'Date: ' + dateStr;
    }

    document.getElementById('previewBtn').addEventListener('click', syncPreview);

    document.getElementById('generateBtn').addEventListener('click', async () => {
      syncPreview(); // ensure latest values
      const certEl = document.getElementById('certificate');
      const canvas = await html2canvas(certEl, { scale: 2 });
      const imgData = canvas.toDataURL('image/png');

      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({ orientation: 'landscape', unit: 'pt', format: 'a4' });

      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      const ratio = Math.min(pageWidth / canvas.width, pageHeight / canvas.height);

      const x = (pageWidth - canvas.width * ratio) / 2;
      const y = (pageHeight - canvas.height * ratio) / 2;

      pdf.addImage(imgData, 'PNG', x, y, canvas.width * ratio, canvas.height * ratio);
      pdf.save((document.getElementById('recipient').value || 'Certificate') + '.pdf');
    });
  </script>
</body>
</html>
